<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>YES IT'S ME</title>
  <style>
    :root{ --bg:#071738; --fg:#ffffff; --muted:#c7d2fe; --brand:#451186; --panel:#0b204a; --border:#132a63; }
    html,body{margin:0;padding:0;background:var(--bg);color:var(--fg);font-family:system-ui,-apple-system,Segoe UI,Inter,Roboto,sans-serif}
    .wrap{max-width:780px;margin:40px auto;padding:0 16px;text-align:center}
    h1{font-size:56px;letter-spacing:1.5px;margin:0 0 24px;font-weight:800}
    .hint{color:var(--muted);font-size:13px;margin-bottom:18px}
    .row{display:flex;gap:12px;justify-content:center;align-items:center;flex-wrap:wrap;margin-bottom:12px}
    .btn{appearance:none;border:0;padding:10px 14px;border-radius:10px;cursor:pointer;font-weight:700}
    .btn.primary{background:var(--brand);color:#fff}
    .btn.dark{background:#0f1f49;color:#fff}
    .btn:disabled{opacity:.5;cursor:not-allowed}
    .file-label{border:1px solid var(--border);background:#0f1f49;color:#fff;border-radius:10px;padding:8px 12px;cursor:pointer;font-weight:700}
    #wave{height:110px;margin:12px 0;border-radius:10px;overflow:hidden;background:var(--panel);border:1px solid var(--border)}
    #evidence{margin:0 0 16px;border-radius:10px;overflow:hidden;background:#040e26;border:1px solid var(--border);position:relative}
    #riskStrip{display:block;width:100%;height:120px;background:#040e26}
    #votes{margin:12px;padding:0 12px}
    #metaBadges{margin:0 0 12px;padding:0 12px;display:flex;gap:8px;flex-wrap:wrap}
    #summaryCard{margin:0;padding:12px;border-top:1px solid var(--border);background:var(--panel)}
    .badge{background:#0f1f49;color:#fff;padding:4px 8px;border-radius:6px;font-size:11px;font-weight:600}
    .vote{margin:6px 0;display:flex;align-items:center;gap:8px}
    .vote-bar{height:12px;border-radius:6px;overflow:hidden;background:#374151}
    .vote-fill{height:100%;transition:width 0.3s}
    .vote-label{font-size:12px;color:var(--muted);min-width:80px}
    .vote-score{font-size:12px;color:#fff}
    .legend{margin:8px 0 0;font-size:11px;color:var(--muted)}
    .legend span{margin-right:12px}
    .legend .auth{color:#3409f6}
    .legend .man{color:#ef4444}
    .legend .inc{color:#9ca3af}
    .cursor{position:absolute;top:0;left:0;width:2px;height:120px;background:#fff;z-index:10;pointer-events:none}
    .analyze{width:340px;margin:18px auto 8px;border-radius:12px}
    .meter{height:18px;font-size:12px;color:var(--muted);margin:6px 0 18px}
    .result{max-width:560px;margin:16px auto;text-align:left;border:1px solid var(--border);border-radius:12px;padding:14px;background:var(--panel)}
    .kv{display:flex;justify-content:space-between;margin:4px 0}
    details summary{cursor:pointer;user-select:none}
    .hidden{display:none}
    input[type=file]{display:none}
    pre{color:#dbeafe}
  </style>

  <!-- единая версия core+plugin -->
  <script src="https://unpkg.com/wavesurfer.js@7.7.13"></script>
  <script src="https://unpkg.com/wavesurfer.js@7.7.13/dist/plugins/spectrogram.min.js"></script>
</head>
<body>
  <div class="wrap">
    <h1>YES IT'S ME</h1>
    <div class="hint"><strong>PLEASE UPLOAD OR RECORD AUDIO CLIP (10 seconds to 5 minutes)</strong></div>
    <div class="hint">Single-speaker audio or turn-taking conversations / up to 100MB</div>
    <div class="hint">wav, flac, mp3, m4a, aac, ogg, opus</div>
    <div class="hint">English, Spanish, Portuguese, Italian, German, French, Russian, Mandarin</div>

    <div class="row">
      <label class="file-label" id="fileLabel">
        Load audio file
        <input id="file" type="file" accept="audio/*" />
      </label>

      <button id="recBtn" class="btn dark">● REC</button>
      <button id="playBtn" class="btn dark" disabled>▶︎ Play</button>
      <span id="timer" style="color:var(--muted);font-size:12px">00:00</span>
      <span id="fileMeta" style="color:var(--muted);font-size:12px"></span>
    </div>

    <div id="wave"></div>
    <div id="evidence">
      <canvas id="riskStrip" height="120"></canvas>
      <div class="cursor" id="riskCursor"></div>
      <div id="votes"></div>
      <div id="metaBadges"></div>
      <div id="summaryCard"></div>
    </div>

    <button id="analyzeBtn" class="btn primary analyze" disabled>Analyze</button>
    <div id="meter" class="meter">0.0 s</div>
    <div id="result" class="result hidden">
      <div class="kv"><strong>Verdict</strong><span id="verdict">-</span></div>
      <div class="kv"><strong>Confidence</strong><span id="conf">-</span></div>
      <div class="kv"><strong>Status</strong><span id="status">-</span></div>
      <div class="kv"><strong>Request ID</strong><span id="rid">-</span></div>
      <details style="margin-top:8px">
        <summary>Raw JSON</summary>
        <pre id="raw" style="white-space:pre-wrap;font-size:12px;background:#08183a;border:1px solid var(--border);padding:8px;border-radius:8px;max-height:280px;overflow:auto"></pre>
      </details>
    </div>
  </div>

  <!-- Ensure required DOM nodes exist before app.js executes -->
  <script>
    (function ensureDom() {
      if (!document.getElementById('meter')) {
        const meter = document.createElement('div');
        meter.id = 'meter';
        meter.className = 'meter';
        meter.textContent = '0.0 s';
        const btn = document.getElementById('analyzeBtn');
        (btn?.parentNode || document.body).insertBefore(meter, document.getElementById('result'));
      }
    })();
  </script>
  <script src="./app.js?v=20251021-11" defer></script>
</body>
</html>